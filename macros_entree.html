<CONTENT VERSION="1.0" LANG="fr" CHARSET="utf-8"/>

/**
 * Initialisation de la page.
 */
<DEFMACRO NAME="ENTREE_INIT">
	<!--[ Dépendances additionnelles ]-->
	<USE MACROFILE="macros_publication.html" />

	<LET VAR="titre_page" GLOBAL="1">
		<IF COND="[#TYPE.TITLE]"><IF COND="[#TYPE.ALTERTITLE:#SITELANG]">[#TYPE.ALTERTITLE:#SITELANG]<ELSE/>[#TYPE.TITLE]</IF></IF><IF COND="[#NOMFAMILLE] AND [#PRENOM]"/> - [#NOMFAMILLE] [#PRENOM]<ELSEIF COND="[#IDENTRY] AND [#NOM]"/> - [#NOM]</IF> &ndash; [#OPTIONS.METADONNEESSITE.TITRESITE]
	</LET>
</DEFMACRO>

/**
 * Macro principale appelée par le template.
 */
<DEFMACRO NAME="ENTREE_MAIN">
	<MACRO NAME="ENTREE_TITLE" />
	<MACRO NAME="ENTREE_LISTE" />
	<MACRO NAME="ENTREE_RETOUR" />
</DEFMACRO>

/**
 * Titre h1 de l'entrée.
 */
<DEFMACRO NAME="ENTREE_TITLE">
	<IF COND="[#NOM]">
		<h1 class="main-title entry__title">
			<IF COND="[#TYPE.ALTERTITLE:#SITELANG]">[#TYPE.ALTERTITLE:#SITELANG]<ELSE/>[#TYPE.TITLE]</IF>&#160;&#8211; [#NOM]
		</h1>
	<ELSEIF COND="[#NOMFAMILLE]" />
		<h1 class="main-title entry__title">
			[#PRENOM] <span class="family-name">[#NOMFAMILLE]</span>
		</h1>
	</IF>
</DEFMACRO>

/**
 * Affichage des entités associées à l'entrée.
 */
<DEFMACRO NAME="ENTREE_LISTE">
	<LET VAR="entree_liste_li">
		<MACRO NAME="ENTREE_LISTE_TEXTES"/>
		<MACRO NAME="ENTREE_LISTE_NUMEROS"/>
	</LET>
	<IF COND="[#ENTREE_LISTE_LI]">
		<section class="toc toc--entry">
			<ul class="toc__contents toc__contents--entry toc__contents--entry-class-[#TYPE.CLASS] toc__contents--entry-type-[#TYPE.TYPE]">
				[#ENTREE_LISTE_LI]
			</ul>
		</section>
	</IF>
</DEFMACRO>

/**
 * Affichage des textes associés à l'entrée.
 */
<DEFMACRO NAME="ENTREE_LISTE_TEXTES">
	<LOOP NAME="entree_liste_textes" TABLE="textes" WHERE="identry='[#ID]' AND id [#NOT_IN_TRADUCTIONS]" ORDER="datepubli DESC">
		<li class="toc__li toc__li toc__li--class-textes">
			<FUNC NAME="PUBLICATION_LI_TEXTE"/>
		</li>
	</LOOP>
</DEFMACRO>

/**
 * Affichage des numéros associés à l'entrée.
 */
 <DEFMACRO NAME="ENTREE_LISTE_NUMEROS">
	<LOOP NAME="entree_liste_numeros" TABLE="publications" WHERE="identry='[#ID]' AND type='numero'" ORDER="datepubli DESC">
		<li class="toc__li toc__li toc__li--class-textes">
			<a href="[#ID|makeurlwithid]">
				<span class="publi-number">[#NUMERO]<FUNC NAME="BASE_PERIODE_PUBLI" PREPEND="&nbsp;| " /></span>
				<LET VAR="ml_titre"><FUNC NAME="BASE_ML_TITRE" /></LET>
				<div class="publi-title">[#ML_TITRE]</div>
			</a>
		</li>
	</LOOP>
</DEFMACRO>

/**
 * Bouton "Retour à l'index".
 */
<DEFMACRO NAME="ENTREE_RETOUR">
	<div class="button-back-container">
		<a rev="index" class="button-back arrow-before" href="[#TYPE.ID|makeurlwithid]">[@RETOUR_INDEX]</a>
	</div>
</DEFMACRO>
